<!DOCTYPE HTML>
<html>

<head>
	<meta charset="utf-8">
	<title>BG真人娱乐</title>
	<meta name="viewport" id="viewport"
		content="width=device-width,initial-scale=1.0 ,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	<meta name="apple-mobile-web-app-status-bar-style" content="black">
	<meta name="mobile-web-app-capable" content="yes" />
	<meta name="full-screen" content="true" />
	<meta name="360-fullscreen" content="true" />
	<meta name="theme-color" content="#000">
	<!-- UC强制全屏 -->
	<meta name="full-screen" content="yes" />
	<meta name="browsermode" content="application" />
	<!-- QQ强制全屏 -->
	<meta name="x5-fullscreen" content="true" />
	<meta name="x5-page-mode" content="app" />
	<link href="css/style.css" rel="stylesheet">
	<link rel="manifest" id="my-manifest-placeholder">
	<style>
		body,
		html {
			margin: 0;
			padding: 0;
			border: 0;
			background: #000;
			font-family: '微软雅黑', '微軟正黑體', Arial;
			-ms-touch-action: none;
			-webkit-overflow-scrolling: touch
		}
	</style>
</head>

<body>
	<script>
		var ua = navigator.userAgent || navigator.vendor || window.opera;
		var pwa = (navigator.standalone || window.matchMedia("(display-mode: fullscreen)").matches);
		var version =  "4.0.8.13"
		if (pwa) {			
			cacheHandle();
			function cacheHandle() {
				var bReloading;
				var reload = function (force = false) {
					if (!bReloading) {
						var ask;
						bUrlLogout = true;
						bReloading = true;
						console.warn('===================  window.location.reload =======================', performance.now());
						window.location.reload();
					}
				}
				if ('serviceWorker' in navigator) {
					let scope = self.location.pathname;
					let idx = scope.lastIndexOf("/")
					scope = scope.substring(0, idx + 1);
					console.warn('serviceWorker start', scope, performance.now());
					if (navigator.serviceWorker.controller) {
						console.warn('serviceWorker controller postMessage ', version, performance.now());
						navigator.serviceWorker.controller.postMessage({ type: "VERSION", value: version });
					}
					navigator.serviceWorker.addEventListener('message', (e) => {
						const data = e.data;
						if (data && data.type == "reload")
							reload();
					});
					navigator.serviceWorker.register('index_serviceworker.js', { scope: scope }).then(function (reg) {
						console.warn("ServiceWorker registration success ", performance.now());
						reg.update();
						var curState;
						if (reg.installing) {
							console.warn('serviceWorker installing', performance.now());
							curState = reg.installing;
						} else if (reg.waiting) {
							console.warn('serviceWorker waiting', performance.now());
							curState = reg.waiting;
						} else if (reg.active) {
							console.warn('serviceWorker active', performance.now());
							curState = reg.active;
							reg.onupdatefound = function () {
								console.warn("serviceWorker onupdatefound", performance.now());
								reload();
							}
						}
						if (curState) {
							curState.addEventListener("statechange", (e) => {
								console.warn("serviceWorker statechange", e.target.state, performance.now());
								switch (e.target.state) {
									case "installed":
										reload(true);
										break;
									case "redundant":
										reload();
										break;
								}
							});
						}
					});
				}
			}
		} else {
			var main;
			var content;
			var infoImage;
			main = document.createElement("div");
			main.id = "mainPWA";
			content = document.createElement("div");
			content.id = "contentPWA";
			infoImage = document.createElement("img");
			infoImage.id = "infoImage";
			main.appendChild(content);
			document.body.appendChild(main);
			var h1 = document.createElement("h1");
			if (ua.match(/Android/i)) {
				h1.innerText = "請添加到主畫面(android)"
				infoImage.src = "images/pwa_android.png";
			} else {
				h1.innerText = "請添加到主畫面(IOS)"
				infoImage.src = "images/pwa_ios.jpg";
			}
			content.appendChild(h1);
		}
		content.appendChild(infoImage);




	</script>
</body>

</html>